rules:
  - name: velocity
    intervalSeconds: 60
    limit: 10
    strategy: average
    
  - name: denylist
    sourceList: redis
    ips:
      - 1.2.3.4
    cidrs:
      - 192.168.1.0/24
    strategy: override

  - name: horizontalBruteForce
    intervalSeconds: 5
    distinctAccounts: 2
    strategy: override

services:
  nats:
    url: "nats://localhost:4222"
    enabled: false
    threshold: 0.1
  redis:
    enabled: true
    host: localhost:6379